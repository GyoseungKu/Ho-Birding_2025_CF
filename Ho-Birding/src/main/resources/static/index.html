<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>조류 MBTI</title>
    <style>
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }
    </style>
</head>
<body>
<form id="questionnaireForm">
    <div id="page1" class="page active">
        <p>닉네임 입력</p>
        <input type="text" id="name" name="name" required>
        </br></br>
        <button type="button" onclick="nextPage()">시작</button>
    </div>
    <div id="page2" class="page">
        <p>질문 1</p>
        <button type="button" onclick="selectAnswer('page2', 1)">Option 1</button>
        <button type="button" onclick="selectAnswer('page2', 0)">Option 2</button>
    </div>
    <div id="page3" class="page">
        <p>질문 2</p>
        <button type="button" onclick="selectAnswer('page3', 1)">Option 1</button>
        <button type="button" onclick="selectAnswer('page3', 0)">Option 2</button>
    </div>
    <div id="page4" class="page">
        <p>질문 3</p>
        <button type="button" onclick="selectAnswer('page4', 1)">Option 1</button>
        <button type="button" onclick="selectAnswer('page4', 0)">Option 2</button>
    </div>
    <div id="page5" class="page">
        <p>질문 4</p>
        <button type="button" onclick="selectAnswer('page5', 1)">Option 1</button>
        <button type="button" onclick="selectAnswer('page5', 0)">Option 2</button>
    </div>
    <div id="page6" class="page">
        <p>질문 5</p>
        <button type="button" onclick="selectAnswer('page6', 1)">Option 1</button>
        <button type="button" onclick="selectAnswer('page6', 0)">Option 2</button>
    </div>
    <div id="page7" class="page">
        <p>질문 6</p>
        <button type="button" onclick="selectAnswer('page7', 1)">Option 1</button>
        <button type="button" onclick="selectAnswer('page7', 0)">Option 2</button>
    </div>
    <div id="page8" class="page">
        <p>질문 7</p>
        <button type="button" onclick="selectAnswer('page8', 1)">Option 1</button>
        <button type="button" onclick="selectAnswer('page8', 0)">Option 2</button>
    </div>
    <div id="page9" class="page">
        <p>제출?</p>
        <button type="submit">제출하기</button>
    </div>
    <div id="resultPage" class="page">
        <p id="resultMessage"></p>
        <button type="button" onclick="retakeSurvey()">다시 설문하기</button>
    </div>
</form>

<script>
    let currentPage = 1;

    function nextPage() {
        document.getElementById(`page${currentPage}`).classList.remove('active');
        currentPage++;
        document.getElementById(`page${currentPage}`).classList.add('active');
    }

    function selectAnswer(pageId, answer) {
        document.getElementById(pageId).dataset.answer = answer;
        if (currentPage < 9) {
            nextPage();
        }
    }

    function retakeSurvey() {
        currentPage = 1;
        document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
        document.getElementById('page1').classList.add('active');
        document.getElementById('questionnaireForm').reset();
    }

    document.getElementById('questionnaireForm').addEventListener('submit', function(event) {
        event.preventDefault();
        const answers = { name: document.getElementById('name').value };
        for (let i = 2; i <= 8; i++) {
            answers[`q${i-1}`] = document.getElementById(`page${i}`).dataset.answer;
        }

        fetch('/submit', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(answers)
        })
            .then(response => response.json())
            .then(data => {
                console.log('Success:', data);
                // Show MBTI result page
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                document.getElementById('resultPage').classList.add('active');
                document.getElementById('resultMessage').innerText = '당신의 mbti는? aaaa입니다';
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    });
</script>
</body>
</html>